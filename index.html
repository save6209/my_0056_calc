<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>0056 æ§“æ¡¿è¤‡åˆ©æ±ºç­–ç³»çµ± V11</title>
    <script src="[https://cdn.tailwindcss.com"></script]https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
    <style>
        body { background-color: #f8fafc; font-family: 'Inter', sans-serif; }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        .card { @apply bg-white rounded-3xl p-6 shadow-sm border border-slate-100; }
        .label-txt { @apply text-[10px] font-extrabold text-slate-400 uppercase tracking-widest mb-1 block; }
        .input-box { @apply w-full text-xl font-bold text-slate-800 outline-none border-b-2 border-slate-100 focus:border-blue-600 bg-transparent py-2 transition-all; }
        .tab-btn { @apply flex-1 py-4 text-sm font-bold text-slate-400 transition-all rounded-2xl; }
        .tab-btn.active { @apply bg-white text-blue-600 shadow-md; }
    </style>
</head>
<body class="min-h-screen p-4 md:p-10">
    <div class="max-w-6xl mx-auto">
        <header class="mb-8 text-center">
            <h1 class="text-3xl font-black text-slate-900 tracking-tight">0056 æ§“æ¡¿è¤‡åˆ©ç²¾ç®—ç³»çµ±</h1>
            <p class="text-xs text-blue-600 font-bold uppercase tracking-[0.2em] mt-2">V11 - Price History & Compounding</p>
        </header>

        <div class="flex bg-slate-200/50 p-1.5 rounded-[24px] mb-8 max-w-md mx-auto">
            <button onclick="showTab('calc')" class="tab-btn active" id="btn-calc">ğŸ’° è¤‡åˆ©æ¨¡æ“¬</button>
            <button onclick="showTab('risk')" class="tab-btn" id="btn-risk">ğŸ“‰ 0056 æ­·å²æˆç¸¾</button>
        </div>

        <div id="calc-tab" class="tab-content active space-y-6">
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4">
                <div class="card"><label class="label-txt">åˆå§‹æœ¬é‡‘ (è¬)</label><input type="number" id="principal" value="50" class="input-box"></div>
                <div class="card bg-blue-50 border-blue-100"><label class="label-txt text-blue-600">æ¯å¹´å†æŠ•å…¥ (è¬)</label><input type="number" id="annualAdd" value="10" class="input-box text-blue-800 border-blue-200"></div>
                <div class="card"><label class="label-txt">æ‰€å¾—ç¨…ç‡</label><select id="taxRate" class="input-box"><option value="0.05">5%</option><option value="0.20">20%</option></select></div>
                <div class="card"><label class="label-txt">å¹´åŒ–æ®–åˆ©ç‡ %</label><input type="number" id="yieldRate" value="7.5" step="0.1" class="input-box"></div>
                <div class="card"><label class="label-txt">å¹´åŒ–å¢å€¼ %</label><input type="number" id="priceGrowth" value="3.5" step="0.1" class="input-box"></div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div class="card border-l-8 border-indigo-500">
                    <h3 class="text-indigo-600 font-black text-xs mb-3 text-indigo-400">è³ªæŠ¼è² å‚µ (ä¸é‚„æœ¬)</h3>
                    <div class="grid grid-cols-2 gap-4">
                        <div><label class="label-txt text-indigo-400">æˆæ•¸ %</label><input type="number" id="sLoanPerc" value="60" class="input-box"></div>
                        <div><label class="label-txt text-indigo-400">åˆ©ç‡ %</label><input type="number" id="sLoanRate" value="2.5" class="input-box"></div>
                    </div>
                </div>
                <div class="card border-l-8 border-rose-500">
                    <h3 class="text-rose-600 font-black text-xs mb-3 text-rose-400">ä¿¡è²¸è² å‚µ (æœ¬æ¯æ”¤)</h3>
                    <div class="grid grid-cols-3 gap-4">
                        <div><label class="label-txt text-rose-400">é‡‘é¡ (è¬)</label><input type="number" id="pLoanAmt" value="50" class="input-box"></div>
                        <div><label class="label-txt text-rose-400">åˆ©ç‡ %</label><input type="number" id="pLoanRate" value="2.1" class="input-box"></div>
                        <div><label class="label-txt text-rose-400">å¹´é™</label><input type="number" id="pLoanTerm" value="7" class="input-box"></div>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="flex justify-between items-center mb-4 text-sm font-bold text-slate-500"><span>è§€å¯Ÿå¹´æ•¸</span><span class="text-blue-600 font-black"><span id="yearVal">10</span> å¹´</span></div>
                <input type="range" id="years" min="1" max="30" value="10" oninput="document.getElementById('yearVal').innerText=this.value" class="w-full h-2 bg-slate-200 rounded-lg cursor-pointer">
            </div>

            <button onclick="calculate()" class="w-full bg-slate-900 text-white font-black py-5 rounded-[2rem] shadow-xl hover:bg-black transition-all">åŸ·è¡Œè³‡ç”¢æ¨¡æ“¬</button>

            <div id="resultArea" class="hidden space-y-6">
                <div class="grid grid-cols-1 md:grid-cols-4 gap-4 text-center">
                    <div class="card bg-slate-900 text-white"><p class="label-txt text-slate-500">æœŸæœ«ç¸½å¸‚å€¼</p><p id="sumMV" class="text-2xl font-black"></p></div>
                    <div class="card bg-blue-50"><p class="label-txt text-blue-600">é ä¼°æ·¨è³‡ç”¢</p><p id="sumNet" class="text-2xl font-black text-blue-900"></p></div>
                    <div class="card bg-indigo-50"><p class="label-txt text-indigo-600">æ‰£è³ªæŠ¼æ·¨å€¼</p><p id="sumEquity" class="text-2xl font-black text-indigo-900"></p></div>
                    <div class="card bg-emerald-50"><p class="label-txt text-emerald-600">è¶…é¡ç´”åˆ©</p><p id="sumProfit" class="text-2xl font-black text-emerald-900"></p></div>
                </div>
                <div class="card p-0 overflow-hidden shadow-2xl overflow-x-auto">
                    <table class="w-full text-[10px] md:text-xs text-left">
                        <thead class="bg-slate-800 text-slate-400">
                            <tr>
                                <th class="p-4">å¹´</th><th class="p-4">ç¸½å¸‚å€¼</th><th class="p-4 text-blue-400">æ·¨è³‡ç”¢</th><th class="p-4 text-indigo-400">æ‰£è³ªæŠ¼æ·¨å€¼</th><th class="p-4 text-emerald-400">è¶…é¡ç´”åˆ©</th><th class="p-4 text-rose-400">ä¿¡è²¸é¤˜é¡</th><th class="p-4 text-right">ç¾é‡‘æµ</th>
                            </tr>
                        </thead>
                        <tbody id="detailBody" class="divide-y divide-slate-100 font-medium text-slate-600"></tbody>
                    </table>
                </div>
            </div>
        </div>

        <div id="risk-tab" class="tab-content space-y-6">
            <div class="card bg-slate-900 text-white p-8">
                <h2 class="text-2xl font-black">0056 å…ƒå¤§é«˜è‚¡æ¯æ­·å¹´è¡¨ç¾</h2>
                <p class="text-slate-400 text-xs mt-1">çœŸå¯¦æ•¸æ“šï¼š2015-2024 (å¹´åº¦çµç®—)</p>
            </div>
            <div class="card p-0 overflow-hidden shadow-xl overflow-x-auto">
                <table class="w-full text-xs text-left">
                    <thead class="bg-slate-100 text-slate-600 font-bold uppercase">
                        <tr>
                            <th class="p-4">å¹´ä»½</th>
                            <th class="p-4">å¹´å‡è‚¡åƒ¹</th>
                            <th class="p-4">å¹´åº¦æ¼²è·Œ</th>
                            <th class="p-4">é…æ¯ (å…ƒ)</th>
                            <th class="p-4 text-blue-600">æ®–åˆ©ç‡</th>
                        </tr>
                    </thead>
                    <tbody id="historyBody" class="divide-y divide-slate-50"></tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        function showTab(tab) {
            document.querySelectorAll('.tab-content').forEach(el => el.classList.remove('active'));
            document.querySelectorAll('.tab-btn').forEach(el => el.classList.remove('active'));
            document.getElementById(tab + '-tab').classList.add('active');
            document.getElementById('btn-' + tab).classList.add('active');
            if(tab === 'risk') renderHistory();
        }

        function PMT(rate, nper, pv) {
            if (rate <= 0 || nper <= 0) return pv / (nper || 1);
            return (pv * rate * Math.pow(1 + rate, nper)) / (Math.pow(1 + rate, nper) - 1);
        }

        function calculate() {
            try {
                const initialP = parseFloat(document.getElementById('principal').value) || 0;
                const annualAdd = parseFloat(document.getElementById('annualAdd').value) || 0;
                const yr = parseFloat(document.getElementById('yieldRate').value) / 100 || 0;
                const pg = parseFloat(document.getElementById('priceGrowth').value) / 100 || 0;
                const tr = parseFloat(document.getElementById('taxRate').value) || 0.05;
                const slp = parseFloat(document.getElementById('sLoanPerc').value) / 100 || 0;
                const slr = parseFloat(document.getElementById('sLoanRate').value) / 100 || 0;
                const pla = parseFloat(document.getElementById('pLoanAmt').value) || 0;
                const plr = parseFloat(document.getElementById('pLoanRate').value) / 100 || 0;
                const plt = parseInt(document.getElementById('pLoanTerm').value) || 7;
                const obsY = parseInt(document.getElementById('years').value) || 10;

                const sLP = initialP * slp;
                const mPLoan = (pla > 0) ? PMT(plr/12, plt*12, pla) : 0;
                const aPLoan = mPLoan * 12;

                let cMV = initialP + sLP + pla;
                let cPLB = pla;
                let cInv = initialP;
                let tableHTML = "";

                for (let i = 1; i <= obsY; i++) {
                    let div = cMV * yr;
                    let sInt = sLP * slr;
                    let pPay = (i <= plt) ? aPLoan : 0;
                    let taxB = (div * 0.6) * (0.085 - tr);
                    let netF = div - sInt - pPay + taxB;
                   
                    if (i <= plt && pla > 0) {
                        let interest = cPLB * plr;
                        cPLB = Math.max(0, cPLB - (aPLoan - interest));
                    } else { cPLB = 0; }

                    cMV = cMV * (1 + pg) + netF + annualAdd;
                    cInv += annualAdd;

                    let nW = cMV - (sLP + cPLB);
                    let eAS = cMV - sLP;
                    let oP = nW - cInv;

                    tableHTML += `<tr class="hover:bg-slate-50"><td class="p-4 font-bold text-slate-400">${i}Y</td><td class="p-4 font-bold text-slate-800">${cMV.toFixed(0)}è¬</td><td class="p-4 font-black text-blue-600">${nW.toFixed(1)}è¬</td><td class="p-4 font-black text-indigo-600 bg-indigo-50/10">${eAS.toFixed(1)}è¬</td><td class="p-4 font-black text-emerald-600 bg-emerald-50/20">${oP.toFixed(1)}è¬</td><td class="p-4 text-rose-400 font-bold">${cPLB.toFixed(0)}è¬</td><td class="p-4 text-right font-bold ${netF < 0 ? 'text-red-400' : 'text-slate-400'}">${netF.toFixed(1)}è¬</td></tr>`;
                   
                    if (i === obsY) {
                        document.getElementById('sumMV').innerText = cMV.toFixed(0) + "è¬";
                        document.getElementById('sumNet').innerText = nW.toFixed(1) + "è¬";
                        document.getElementById('sumEquity').innerText = eAS.toFixed(1) + "è¬";
                        document.getElementById('sumProfit').innerText = oP.toFixed(1) + "è¬";
                    }
                }
                document.getElementById('resultArea').classList.remove('hidden');
                document.getElementById('detailBody').innerHTML = tableHTML;
                document.getElementById('resultArea').scrollIntoView({ behavior: 'smooth' });
            } catch (e) { console.error(e); }
        }

        function renderHistory() {
            // åŒ…å«å¹´å‡è‚¡åƒ¹çš„çœŸå¯¦æ­·å²
            const hData = [
                {y: 2024, p: "37.5", g: "+7.3%", d: 3.63, r: "9.55%"},
                {y: 2023, p: "32.4", g: "+56.9%", d: 2.20, r: "6.20%"},
                {y: 2022, p: "28.5", g: "-23.8%", d: 2.10, r: "8.26%"},
                {y: 2021, p: "33.1", g: "+11.2%", d: 1.80, r: "5.40%"},
                {y: 2020, p: "28.6", g: "+3.7%", d: 1.60, r: "5.34%"},
                {y: 2019, p: "26.4", g: "+21.0%", d: 1.80, r: "6.23%"},
                {y: 2018, p: "24.2", g: "-4.4%", d: 1.45, r: "6.07%"},
                {y: 2017, p: "23.9", g: "+8.1%", d: 0.95, r: "3.80%"},
                {y: 2016, p: "22.8", g: "+5.1%", d: 1.30, r: "5.62%"},
                {y: 2015, p: "21.5", g: "-12.4%", d: 1.00, r: "4.55%"}
            ];
            let html = "";
            hData.forEach(row => {
                const color = row.g.includes('+') ? 'text-emerald-500' : 'text-red-500';
                html += `<tr>
                    <td class="p-4 font-bold text-slate-500">${row.y}</td>
                    <td class="p-4 font-black text-slate-700">$${row.p}</td>
                    <td class="p-4 font-black ${color}">${row.g}</td>
                    <td class="p-4 font-bold text-slate-700">$${row.d}</td>
                    <td class="p-4 font-black text-blue-600">${row.r}</td>
                </tr>`;
            });
            document.getElementById('historyBody').innerHTML = html;
        }
    </script>
</body>
</html>